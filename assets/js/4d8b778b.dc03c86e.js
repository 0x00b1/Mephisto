"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[8374],{5110:function(t,e,a){a.d(e,{Zo:function(){return u},kt:function(){return h}});var n=a(9703);function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e){if(null==t)return{};var a,n,i=function(t,e){if(null==t)return{};var a,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||(i[a]=t[a]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(i[a]=t[a])}return i}var l=n.createContext({}),d=function(t){var e=n.useContext(l),a=e;return t&&(a="function"==typeof t?t(e):r(r({},e),t)),a},u=function(t){var e=d(t.components);return n.createElement(l.Provider,{value:e},t.children)},c={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},p=n.forwardRef((function(t,e){var a=t.components,i=t.mdxType,o=t.originalType,l=t.parentName,u=s(t,["components","mdxType","originalType","parentName"]),p=d(a),h=i,k=p["".concat(l,".").concat(h)]||p[h]||c[h]||o;return a?n.createElement(k,r(r({ref:e},u),{},{components:a})):n.createElement(k,r({ref:e},u))}));function h(t,e){var a=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var o=a.length,r=new Array(o);r[0]=p;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s.mdxType="string"==typeof t?t:i,r[1]=s;for(var d=2;d<o;d++)r[d]=a[d];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},6463:function(t,e,a){a.r(e),a.d(e,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return d},toc:function(){return u},default:function(){return p}});var n=a(3996),i=a(2313),o=(a(9703),a(5110)),r=["components"],s={sidebar_position:2},l="Working on a custom task",d={unversionedId:"guides/tutorials/custom_react",id:"guides/tutorials/custom_react",isDocsHomePage:!1,title:"Working on a custom task",description:"Now that you've launched a task or two, it's time to get into building your own. This tutorial focuses on giving you the tools to collect the specific data you're looking for by building a task of your own. This tutorial itself won't produce a useful task, but it should be useful for understanding how to go about creating a real one. You don't need any React experience to get through this guide, though it will be helpful for understanding the usage more deeply.",source:"@site/docs/guides/tutorials/custom_react.md",sourceDirName:"guides/tutorials",slug:"/guides/tutorials/custom_react",permalink:"/docs/guides/tutorials/custom_react",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/guides/tutorials/custom_react.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"guides",previous:{title:"Running your first task",permalink:"/docs/guides/tutorials/first_task"},next:{title:"Introducing worker controls",permalink:"/docs/guides/tutorials/worker_controls"}},u=[{value:"1. Getting started",id:"1-getting-started",children:[{value:"1.1 Making a new workspace",id:"11-making-a-new-workspace",children:[],level:3},{value:"1.2 Launching the task",id:"12-launching-the-task",children:[],level:3}],level:2},{value:"2. Providing new data to the task",id:"2-providing-new-data-to-the-task",children:[{value:"2.1 The <code>SharedTaskState</code> object and <code>static_task_data</code> attribute",id:"21-the-sharedtaskstate-object-and-static_task_data-attribute",children:[],level:3},{value:"2.2 Editing <code>static_task_data</code>",id:"22-editing-static_task_data",children:[],level:3}],level:2},{value:"3. Accessing the new data",id:"3-accessing-the-new-data",children:[{value:"3.1 Using React Dev Tools",id:"31-using-react-dev-tools",children:[],level:3},{value:"3.2 Making a component to render the new data",id:"32-making-a-component-to-render-the-new-data",children:[],level:3},{value:"3.3 Adding a component to respond with new data",id:"33-adding-a-component-to-respond-with-new-data",children:[],level:3}],level:2},{value:"4. Setting up a review",id:"4-setting-up-a-review",children:[{value:"4.1 Examining the raw data",id:"41-examining-the-raw-data",children:[],level:3},{value:"4.2 Creating a viewer",id:"42-creating-a-viewer",children:[],level:3}],level:2}],c={toc:u};function p(t){var e=t.components,a=(0,i.Z)(t,r);return(0,o.kt)("wrapper",(0,n.Z)({},c,a,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"working-on-a-custom-task"},"Working on a custom task"),(0,o.kt)("p",null,"Now that you've ",(0,o.kt)("a",{parentName:"p",href:"first_task"},"launched a task or two"),", it's time to get into building your own. This tutorial focuses on giving you the tools to collect the specific data you're looking for by building a task of your own. This tutorial itself won't produce a useful task, but it should be useful for understanding how to go about creating a real one. You don't need any React experience to get through this guide, though it will be helpful for understanding the usage more deeply."),(0,o.kt)("h2",{id:"1-getting-started"},"1. Getting started"),(0,o.kt)("h3",{id:"11-making-a-new-workspace"},"1.1 Making a new workspace"),(0,o.kt)("p",null,"We'll extend from the static react task example, but we'll want to move it to it's own workspace. From within the main Mephisto directory:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cp -r examples/static_react_task/ tmp/static_tutorial/\ncd tmp/static_tutorial/\n")),(0,o.kt)("p",null,"Now that we're here, we should also set up your config file"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},'# hydra_configs/conf/example.yaml \n#@package _global_\ndefaults:\n  - /mephisto/blueprint: static_react_task\n  - /mephisto/architect: local\n  - /mephisto/provider: mock\nmephisto:\n  blueprint:\n    task_source: ${task_dir}/webapp/build/bundle.js\n    link_task_source: false\n    extra_source_dir: ${task_dir}/webapp/src/static\n    units_per_assignment: 1\n  task:\n    task_name: custom-react-tutorial   # Remember to set an appropriate task_name!\n    task_title: "Rating a sentence as good or bad"\n    task_description: "In this task, you\'ll be given a sentence. It is your job to rate it as either good or bad."\n    task_reward: 0.05\n    task_tags: "test,simple,button"\n')),(0,o.kt)("p",null,"The only change we'll make is to the ",(0,o.kt)("inlineCode",{parentName:"p"},"task_name")," (as you should on any new tasks!), but we will update the other fields as we go. It's important to note the ",(0,o.kt)("inlineCode",{parentName:"p"},"task_source")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"extra_source_dir")," arguments though, as this is where the ",(0,o.kt)("inlineCode",{parentName:"p"},"Blueprint")," will be looking a compiled react app bundle, and for extra static resources for the page."),(0,o.kt)("h3",{id:"12-launching-the-task"},"1.2 Launching the task"),(0,o.kt)("p",null,"From the current directory, you should be able to execute the run script and get a job working. We're using a different ",(0,o.kt)("inlineCode",{parentName:"p"},"task_name")," to prevent polluting our later task with data that won't share the same format. It is a good practice to do this with initial iterations, and to change the ",(0,o.kt)("inlineCode",{parentName:"p"},"task_name")," any time you change input or output arguments."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"python run_task.py mephisto.task.task_name=custom-react-tutorial-iterating\n")),(0,o.kt)("p",null,"This will launch a simple task where an annotator is supposed to note a sentence as being good or bad. Clicking a button auto-submits the task. In the next sections we'll add other content. "),(0,o.kt)("p",null,"Moving forward, we'll update this task so that workers are able to edit the text as well as rate the original sentence."),(0,o.kt)("h2",{id:"2-providing-new-data-to-the-task"},"2. Providing new data to the task"),(0,o.kt)("h3",{id:"21-the-sharedtaskstate-object-and-static_task_data-attribute"},"2.1 The ",(0,o.kt)("inlineCode",{parentName:"h3"},"SharedTaskState")," object and ",(0,o.kt)("inlineCode",{parentName:"h3"},"static_task_data")," attribute"),(0,o.kt)("p",null,"We'll begin by modifying the ",(0,o.kt)("inlineCode",{parentName:"p"},"SharedStaticTaskState"),"'s ",(0,o.kt)("inlineCode",{parentName:"p"},"static_task_data")," attribute. For info on this attribute, recall ",(0,o.kt)("inlineCode",{parentName:"p"},"mephisto wut"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ mephisto wut blueprint=static_react_task static_task_data\n\n                Tasks launched from static blueprints need\n                a prebuilt javascript bundle containing the task. We suggest building\n                with our provided useMephistoTask hook.\n            \n\nAdditional SharedTaskState args from SharedStaticTaskState, which may be configured in your run script\ndest              type                      default    help                                     choices    required\n----------------  ------------------------  ---------  ---------------------------------------  ---------  ----------\nstatic_task_data  Iterable[Dict[str, Any]]  []         List or generator that returns dicts of  None       False\n                                                       task data. Generators can be used for\n                                                       tasks with lengths that aren't known at\n                                                       the start of a run, or are otherwise\n                                                       determined during the run.\n")),(0,o.kt)("p",null,"This field replaces using the ",(0,o.kt)("inlineCode",{parentName:"p"},"csv_file")," used in the previous tutorial, allowing our run script to specify data directly. React tasks can be run off of ",(0,o.kt)("inlineCode",{parentName:"p"},".csv")," files as well, if you'd prefer."),(0,o.kt)("p",null,"At the moment, the data we're providing is as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'shared_state = SharedStaticTaskState(\n    static_task_data=[\n        {"text": "This text is good text!"},\n        {"text": "This text is bad text!"},\n    ],\n    ...\n)\n')),(0,o.kt)("p",null,"This corresponds to two ",(0,o.kt)("inlineCode",{parentName:"p"},"Assignment"),"s, each with an entry for ",(0,o.kt)("inlineCode",{parentName:"p"},"text"),". Altering these will change the text that is present, while adding new entries to the array will lead to Mephisto generating more ",(0,o.kt)("inlineCode",{parentName:"p"},"Assignment"),"s. "),(0,o.kt)("h3",{id:"22-editing-static_task_data"},"2.2 Editing ",(0,o.kt)("inlineCode",{parentName:"h3"},"static_task_data")),(0,o.kt)("p",null,"For now let's just edit the data and add a new field. Update the ",(0,o.kt)("inlineCode",{parentName:"p"},"static_task_data")," to look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'static_task_data=[\n    {"text": "I have edited this text! Now it is extra good", "edited_by_requester": True},\n    {"text": "This text is bad text!", "edited_by_requester": False},\n],\n')),(0,o.kt)("p",null,"At this point you can run the task again."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"python run_task.py mephisto.task.task_name=custom-react-tutorial-iterating\n")),(0,o.kt)("p",null,"Note the first one you work on displays your new edited text. But what about the new ",(0,o.kt)("inlineCode",{parentName:"p"},"edited")," field?"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Tip:")," In your own tasks, you can use a function that creates static task data, or even a generator for it, but this is discussed more in the ",(0,o.kt)("a",{parentName:"p",href:"workflows"},"workflows")," tutorial.")),(0,o.kt)("h2",{id:"3-accessing-the-new-data"},"3. Accessing the new data"),(0,o.kt)("h3",{id:"31-using-react-dev-tools"},"3.1 Using React Dev Tools"),(0,o.kt)("p",null,"TODO - Show the user how to install react dev tools, then direct them to be able to see the field in a running task"),(0,o.kt)("h3",{id:"32-making-a-component-to-render-the-new-data"},"3.2 Making a component to render the new data"),(0,o.kt)("p",null,"TODO - Create a component that says whether or not the sentence was edited."),(0,o.kt)("h3",{id:"33-adding-a-component-to-respond-with-new-data"},"3.3 Adding a component to respond with new data"),(0,o.kt)("p",null,"TODO - update the send part, such that you now send the data of the edited text when rated ",(0,o.kt)("inlineCode",{parentName:"p"},"bad"),"."),(0,o.kt)("h2",{id:"4-setting-up-a-review"},"4. Setting up a review"),(0,o.kt)("h3",{id:"41-examining-the-raw-data"},"4.1 Examining the raw data"),(0,o.kt)("p",null,"TODO - show creating a review script for the raw data"),(0,o.kt)("h3",{id:"42-creating-a-viewer"},"4.2 Creating a viewer"),(0,o.kt)("p",null,"TODO - write an actual viewer."),(0,o.kt)("h1",{id:"pointer-to-annotated"},"Pointer to @Annotated"),(0,o.kt)("p",null,"TODO - quick note to check out annotated storybook for design ideas and components to use"))}p.isMDXComponent=!0}}]);